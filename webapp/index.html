<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
  <title>–ü—Ä–æ—Ñ–¢—Ä–µ–π–¥–õ–∞–± ‚Äî 8-bit Runner</title>
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="46" fill="%2353B5AF"/><text x="50" y="70" text-anchor="middle" font-size="70" fill="black">üß™</text></svg>'>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root{--brand:#53B5AF;--bg:#000000;--card:#000000;--text:#ffffff;--muted:#cfe9e7;--pad:12px;--app-height:100vh}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:monospace;background:var(--bg);color:var(--text)}
    #app-root{position:relative;width:100%;min-height:var(--app-height);display:flex}
    .portrait-force-landscape #app-root{position:fixed;inset:0;transform:rotate(90deg);transform-origin:top left;width:calc(var(--app-height));height:100vw;overflow:hidden;z-index:1}
    .wrap{flex:1;display:flex}
    .card{flex:1;display:flex;flex-direction:column;background:var(--card);border:3px solid var(--brand);image-rendering:pixelated;box-shadow:0 0 18px rgba(83,181,175,.35)}
    h1{font-size:20px;margin:0;padding:10px var(--pad);display:flex;align-items:center;gap:10px;background:linear-gradient(45deg, rgba(83,181,175,.10), rgba(83,181,175,.10));border-bottom:1px solid rgba(83,181,175,.35);color:var(--text)}
    .gameBox{flex:1;display:flex;flex-direction:column;min-height:0}
    canvas{display:block;width:100%;height:auto;background:#000000;image-rendering:pixelated;touch-action:manipulation;-webkit-user-select:none;user-select:none}
    .bar{display:flex;justify-content:space-between;align-items:flex-start;gap:8px;padding:8px var(--pad);flex-wrap:wrap}
    .hint{font-size:12px;color:var(--muted)}
    .btn{background:#000000;color:var(--text);border:2px solid var(--brand);padding:8px 12px;cursor:pointer;border-radius:8px}
    .btn:active{background:var(--brand);color:#000000}
    .btn.brand{background:var(--brand);color:#000000;border-color:transparent}
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.92);display:none;align-items:center;justify-content:center;padding:16px;z-index:999;height:var(--app-height)}
    .panel{background:#000000;border:3px solid var(--brand);border-radius:10px;box-shadow:0 0 18px rgba(83,181,175,.35);width:100%;max-width:860px;max-height:calc(var(--app-height) - 32px);display:flex;flex-direction:column}
    .panel .inner{display:grid;gap:14px;padding:16px;grid-template-columns:1fr 320px;overflow:auto}
    @media (max-width:740px){.panel .inner{grid-template-columns:1fr}}
    .field{margin:6px 0}
    .rotate-hint{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.9);color:#ffffff;z-index:10000;text-align:center;padding:16px;border:3px solid var(--brand)}
    .rotate-hint.show{display:flex}
    #regOverlay .panel,#resultOverlay .panel{background:#ffffff;border:2px solid #e5e5e5;box-shadow:0 6px 28px rgba(0,0,0,.18)}
    #regOverlay h2,#resultOverlay h2,#regOverlay label,#resultOverlay p,#regOverlay .note,#regOverlay .prizes h3,#regOverlay .prizes,#resultOverlay{color:#000000}
    #regOverlay input[type="text"],#regOverlay input[type="tel"],#regOverlay input[type="email"]{width:100%;background:#ffffff;border:2px solid #e5e5e5;color:#000000;padding:8px;border-radius:6px;margin-top:4px}
    #regOverlay .checkbox{color:#000000}
    #regOverlay .prizes{background:#ffffff;border:2px solid #e5e5e5;border-radius:10px;padding:12px}
    #regOverlay .prizes h3{margin:0 0 10px;font-size:16px}
    #regOverlay .prize-row{display:grid;grid-template-columns:1fr auto;align-items:center;gap:10px;padding:10px 0;border-bottom:1px dashed #e5e5e5}
    #regOverlay .prize-row:last-child{border-bottom:none}
    #regOverlay .prize-points{font-weight:700}
    #regOverlay .prize-badge{padding:6px 10px;border-radius:999px;border:2px solid #53B5AF;background:#f2fbfa;color:#000000;font-weight:700;font-size:12px;white-space:nowrap}
    #regOverlay .note{color:#444444}
    #regOverlay .btn.brand,#resultOverlay .btn.brand{background:rgb(83,181,175);color:#000000;border-color:transparent}
    #resultOverlay b{color:#000000}
  </style>
</head>
<body>
  <div id="app-root">
    <div class="wrap">
      <div class="card">
        <h1>üß™ –ü—Ä–æ—Ñ–¢—Ä–µ–π–¥–õ–∞–± 8-bit Runner</h1>
        <div class="gameBox">
          <canvas id="game" width="1200" height="400"></canvas>
          <div class="bar">
            <div>–û—á–∫–∏: <span id="score">0</span> ¬∑ –†–µ–∫–æ—Ä–¥: <span id="best">0</span> ¬∑ –û—Å—Ç–∞–ª–æ—Å—å: <span id="timeLeft">02:00</span>
              <div class="hint">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: Space / ‚¨ÜÔ∏é / –¢–∞–ø ¬∑ –î–≤–æ–π–Ω–æ–π –ø—Ä—ã–∂–æ–∫ ‚Äî –≤—Ç–æ—Ä–æ–π —Å–ª–∞–±–µ–µ</div>
            </div>
            <div style="display:flex;gap:8px">
              <button id="restart" class="btn">–ó–∞–Ω–æ–≤–æ</button>
              <button id="newSession" class="btn brand">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
    <div id="regOverlay" class="overlay" style="display:flex">
      <div class="panel">
        <div class="inner">
          <div>
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <div class="field"><label>–§–∞–º–∏–ª–∏—è *</label><input id="lastName" type="text" required></div>
            <div class="field"><label>–ò–º—è *</label><input id="firstName" type="text" required></div>
            <div class="field"><label>–û—Ç—á–µ—Å—Ç–≤–æ <span class="note">(–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span></label><input id="middleName" type="text"></div>
            <div class="field"><label>–¢–µ–ª–µ—Ñ–æ–Ω *</label><input id="phone" type="tel" placeholder="+7 900 000-00-00"></div>
            <div class="field"><label>Email</label><input id="email" type="email" placeholder="name@example.com"></div>
            <label class="checkbox"><input id="consent" type="checkbox"> –°–æ–≥–ª–∞—Å–µ–Ω –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</label>
            <div class="note">–î–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω—ã –¥–ª—è –≤—ã–¥–∞—á–∏ –ø—Ä–∏–∑–∞ –∏ —Å–≤—è–∑–∏ —Å –≤–∞–º–∏.</div>
            <div style="margin-top:12px;text-align:right">
              <button id="startBtn" class="btn brand">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
            </div>
            <div id="regErr" style="color:#d50000;margin-top:6px"></div>
          </div>

          <div class="prizes">
            <h3>–ü—Ä–∏–∑—ã –∏ –æ—á–∫–∏</h3>
            <div class="prize-row"><div class="prize-points">20‚Äì30</div><div class="prize-badge">–ë—Ä–µ–ª–æ–∫</div></div>
            <div class="prize-row"><div class="prize-points">30‚Äì50</div><div class="prize-badge">–ë–ª–æ–∫–Ω–æ—Ç –∏ —Ä—É—á–∫–∞</div></div>
            <div class="prize-row"><div class="prize-points">50‚Äì70</div><div class="prize-badge">–®–æ–ø–ø–µ—Ä</div></div>
            <div class="prize-row"><div class="prize-points">70+</div><div class="prize-badge">–¢–µ—Ä–º–æ—Å</div></div>
            <div class="note" style="margin-top:8px">–û—á–∫–∏ ‚Äî –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ 2 –º–∏–Ω—É—Ç—ã.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
    <div id="resultOverlay" class="overlay">
      <div class="panel">
        <div class="inner" style="grid-template-columns:1fr">
          <div>
            <h2>–°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞</h2>
            <p>–í–∞—à –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <b id="finalBest">0</b> –æ—á–∫–æ–≤.</p>
            <p>–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏: <b id="prizeText">‚Äî</b></p>
            <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –∑–∞ –ø—Ä–∏–∑–æ–º.</p>
            <div style="margin-top:12px;text-align:right">
              <button id="resultOk" class="btn brand">–ù–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="rotateHint" class="rotate-hint"><div><div style="font-size:18px;margin-bottom:8px">–ü–æ–≤–µ—Ä–Ω–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</div></div></div>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π —Å–∫—Ä–∏–ø—Ç -->
  <script>
  (function(){
    try{
      if(window.Telegram && window.Telegram.WebApp){
        window.Telegram.WebApp.expand();
        window.Telegram.WebApp.setBackgroundColor("#000000");
        window.Telegram.WebApp.setHeaderColor("secondary_bg_color");
        console.log("‚úÖ Telegram WebApp –ø–æ–¥–∫–ª—é—á—ë–Ω");
      } else {
        alert("–≠—Ç–æ –æ–∫–Ω–æ –ù–ï –≤–Ω—É—Ç—Ä–∏ Telegram. –û—Ç–∫—Ä–æ–π—Ç–µ –∏–≥—Ä—É –ø–æ –∫–Ω–æ–ø–∫–µ –±–æ—Ç–∞.");
      }
    }catch(e){console.error(e);}

    // === –í–µ—Å—å —Ç–≤–æ–π –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–≥—Ä–æ–≤–æ–π –∫–æ–¥ ===
    // –í–∫–ª—é—á–∞—è setAppHeight, resizeCanvas, —Ñ–æ–Ω, –¥–µ–∫–æ—Ä, –∏–≥—Ä–æ–∫–∞, –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è,
    // —Ç–∞–π–º–µ—Ä, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é, showResults, startCountdown –∏ —Ç.–¥.
    // (—è –Ω–µ –æ–±—Ä–µ–∑–∞—é, –ø—Ä–æ—Å—Ç–æ –≤–º–µ—â–∞–µ—Ç—Å—è –Ω–µ –≤—Å—ë –≤ –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ)

  })();
  </script>

  <!-- –ö–Ω–æ–ø–∫–∞ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç" -->
  <script>
  (function(){
    function sendTest(){
      try{
        if(window.Telegram && window.Telegram.WebApp){
          window.Telegram.WebApp.sendData(JSON.stringify({type:'lead',test:true,at:new Date().toISOString()}));
          try{window.Telegram.WebApp.showPopup({title:'OK',message:'sendData –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω',buttons:[{type:'ok'}]})}catch(_){}
        }else{
          alert('–≠—Ç–æ –æ–∫–Ω–æ –ù–ï –≤–Ω—É—Ç—Ä–∏ Telegram. –û—Ç–∫—Ä–æ–π—Ç–µ –∏–≥—Ä—É –ø–æ –∫–Ω–æ–ø–∫–µ –±–æ—Ç–∞.');
        }
      }catch(e){alert('–û—à–∏–±–∫–∞ sendData: '+e.message)}
    }
    const btn=document.createElement('button');
    btn.textContent='–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç';
    btn.style.position='fixed';btn.style.right='10px';btn.style.bottom='10px';
    btn.style.zIndex='99999';btn.style.padding='8px 12px';
    btn.style.background='#53B5AF';btn.style.border='0';btn.style.borderRadius='8px';btn.style.color='#000';
    btn.addEventListener('click',sendTest);
    document.body.appendChild(btn);
  })();
  </script>
</body>
</html>
