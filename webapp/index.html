<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover, user-scalable=no" />
  <title>–ü—Ä–æ—Ñ–¢—Ä–µ–π–¥–õ–∞–± ‚Äî 8-bit Runner</title>
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="46" fill="%2353B5AF"/><text x="50" y="70" text-anchor="middle" font-size="70" fill="black">üß™</text></svg>'>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root{--brand:#53B5AF;--bg:#000000;--card:#000000;--text:#ffffff;--muted:#cfe9e7;--pad:12px}
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;width:100vw;height:100vh;overflow:hidden;background:var(--bg);color:var(--text);font-family:monospace}
    #app-root{position:relative;width:100vw;height:100vh;display:flex}
    .wrap{flex:1;display:flex}
    .card{flex:1;display:flex;flex-direction:column;background:var(--card);border:3px solid var(--brand);image-rendering:pixelated;box-shadow:0 0 18px rgba(83,181,175,.35)}
    h1{font-size:18px;margin:0;padding:8px var(--pad);display:flex;align-items:center;gap:10px;background:rgba(83,181,175,.10);border-bottom:1px solid rgba(83,181,175,.35);color:var(--text)}
    .gameBox{flex:1;display:flex;flex-direction:column;min-height:0}
    canvas{display:block;width:100%;height:100%;background:#000;image-rendering:pixelated;touch-action:manipulation;-webkit-user-select:none;user-select:none}
    .bar{position:absolute;left:10px;right:10px;bottom:10px;display:flex;justify-content:space-between;align-items:flex-start;gap:8px;pointer-events:none}
    .bar > *{pointer-events:auto}
    .hint{font-size:12px;color:var(--muted)}
    .btn{background:#000000;color:var(--text);border:2px solid var(--brand);padding:8px 12px;cursor:pointer;border-radius:8px}
    .btn:active{background:var(--brand);color:#000000}
    .btn.brand{background:var(--brand);color:#000000;border-color:transparent}
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.92);display:none;align-items:center;justify-content:center;padding:16px;z-index:9}
    .panel{background:#ffffff;border:2px solid #e5e5e5;border-radius:10px;box-shadow:0 6px 28px rgba(0,0,0,.18);width:100%;max-width:920px;max-height:calc(100vh - 32px);display:flex;flex-direction:column}
    .panel .inner{display:grid;gap:16px;padding:16px;grid-template-columns:1fr 320px;overflow:auto}
    @media (max-width:860px){.panel .inner{grid-template-columns:1fr}}
    .field{margin:6px 0}
    .panel h2,.panel p,.panel label,.panel .note,.panel .muted{color:#000000}
    input[type="text"],input[type="tel"],input[type="email"]{width:100%;background:#ffffff;border:2px solid #e5e5e5;color:#000000;padding:8px;border-radius:6px;margin-top:4px}
    .checkbox{display:flex;gap:8px;align-items:flex-start;color:#000000}
    .note{color:#444444}
    .qrBlock{display:flex;flex-direction:column;align-items:center;gap:10px;border:2px solid #e5e5e5;border-radius:10px;padding:12px;background:#fff}
    .qrBlock img{width:100%;height:auto;display:block}
    .qrTitle{font-weight:700}
  </style>
</head>
<body>
  <div id="app-root">
    <div class="wrap">
      <div class="card">
        <h1>üß™ –ü—Ä–æ—Ñ–¢—Ä–µ–π–¥–õ–∞–± 8-bit Runner</h1>
        <div class="gameBox">
          <canvas id="game" width="1280" height="720"></canvas>
          <div class="bar">
            <div>
              –û—á–∫–∏: <span id="score">0</span> ¬∑ –†–µ–∫–æ—Ä–¥: <span id="best">0</span> ¬∑ –û—Å—Ç–∞–ª–æ—Å—å: <span id="timeLeft">02:00</span>
              <div class="hint">Space / ‚¨ÜÔ∏é / –¢–∞–ø. –î–≤–æ–π–Ω–æ–π –ø—Ä—ã–∂–æ–∫ ‚Äî –≤—Ç–æ—Ä–æ–π —Å–ª–∞–±–µ–µ.</div>
            </div>
            <div style="display:flex;gap:8px">
              <button id="restart" class="btn">–ó–∞–Ω–æ–≤–æ</button>
              <button id="newSession" class="btn brand">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="regOverlay" class="overlay" style="display:flex">
      <div class="panel">
        <div class="inner">
          <div>
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <div class="field"><label>–§–∞–º–∏–ª–∏—è *</label><input id="lastName" type="text" required autocomplete="family-name"></div>
            <div class="field"><label>–ò–º—è *</label><input id="firstName" type="text" required autocomplete="given-name"></div>
            <div class="field"><label>–û—Ç—á–µ—Å—Ç–≤–æ <span class="note">(–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span></label><input id="middleName" type="text" autocomplete="additional-name"></div>
            <div class="field"><label>–¢–µ–ª–µ—Ñ–æ–Ω *</label><input id="phone" type="tel" placeholder="+7 900 000-00-00" autocomplete="tel"></div>
            <div class="field"><label>Email</label><input id="email" type="email" placeholder="name@example.com" autocomplete="email" inputmode="email"></div>
            <label class="checkbox"><input id="consent" type="checkbox"> –°–æ–≥–ª–∞—Å–µ–Ω –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</label>
            <div class="note">–î–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω—ã –¥–ª—è –≤—ã–¥–∞—á–∏ –ø—Ä–∏–∑–∞ –∏ —Å–≤—è–∑–∏ —Å –≤–∞–º–∏.</div>
            <div style="margin-top:12px;text-align:right"><button id="startBtn" class="btn brand">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button></div>
            <div id="regErr" style="color:#d50000;margin-top:6px"></div>
          </div>
          <div class="qrBlock">
            <div class="qrTitle">–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –Ω–∞—à Telegram</div>
            <img src="assets/qr.png" alt="QR" />
            <div class="muted">–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR, —á—Ç–æ–±—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –≥—Ä—É–ø–ø–µ</div>
          </div>
        </div>
      </div>
    </div>

    <div id="resultOverlay" class="overlay">
      <div class="panel">
        <div class="inner" style="grid-template-columns:1fr">
          <div>
            <h2>–°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞</h2>
            <p>–í–∞—à –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <b id="finalBest">0</b> –æ—á–∫–æ–≤.</p>
            <p>–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏: <b id="prizeText">‚Äî</b></p>
            <p>–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –∑–∞ –ø—Ä–∏–∑–æ–º.</p>
            <div style="margin-top:12px;text-align:right;display:flex;gap:8px;justify-content:flex-end">
              <button id="resultOk" class="btn">–ó–∞–∫—Ä—ã—Ç—å</button>
              <button id="resultReg" class="btn brand">–ù–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

<script>
(function(){
  try{if(window.Telegram&&window.Telegram.WebApp){Telegram.WebApp.expand();Telegram.WebApp.setBackgroundColor("#000000");Telegram.WebApp.setHeaderColor("secondary_bg_color")}}catch(e){}
  function goFullScreen(){const el=document.documentElement; if(el.requestFullscreen) el.requestFullscreen(); else if(el.webkitRequestFullscreen) el.webkitRequestFullscreen(); else if(el.msRequestFullscreen) el.msRequestFullscreen()}
  window.addEventListener('load',goFullScreen)

  const canvas=document.getElementById('game');const ctx=canvas.getContext('2d',{alpha:false});let W=canvas.width,H=canvas.height;let GROUND_Y=H-32;
  function fitCanvas(){const dpr=Math.max(1,Math.min(2,window.devicePixelRatio||1));const cssW=window.innerWidth;const cssH=window.innerHeight;canvas.style.width=cssW+'px';canvas.style.height=cssH+'px';canvas.width=Math.round(cssW*dpr);canvas.height=Math.round(cssH*dpr);ctx.setTransform(dpr,0,0,dpr,0,0);W=cssW;H=cssH;GROUND_Y=H-32}
  window.addEventListener('resize',fitCanvas);fitCanvas()

  const bgTile=new Image();bgTile.src="assets/background.png";let bgOffset=0;
  function drawBackground(){if(!bgTile.complete){ctx.fillStyle="#000";ctx.fillRect(0,0,W,H);return}const scale=H/bgTile.height;const tileW=Math.ceil(bgTile.width*scale);const speed=worldSpeed*0.5;bgOffset=(bgOffset-speed);if(bgOffset<=-tileW)bgOffset+=tileW;for(let x=-tileW;x<W+tileW;x+=tileW){ctx.drawImage(bgTile,x+bgOffset,0,tileW,H)}}

  function loadImg(src){const im=new Image();im.src=src;return im}
  const DECOS=[{img:loadImg("assets/deco_clock.png"),w:64,h:64,weight:2},{img:loadImg("assets/deco_panel.png"),w:80,h:80,weight:3},{img:loadImg("assets/deco_console.png"),w:72,h:72,weight:1}]
  const bgDecos=[];let decoTimer=0;const decoMin=1800,decoVar=2200,MAX_DECOS=6
  function pickDeco(){const total=DECOS.reduce((s,d)=>s+d.weight,0);let r=Math.random()*total;for(const d of DECOS){r-=d.weight;if(r<=0)return d}return DECOS[0]}
  function randY(){const t=Math.round(H*0.20),b=Math.round(H*0.45);return Math.floor(t+Math.random()*(b-t))}
  function scheduleDeco(){decoTimer=(performance.now?performance.now():Date.now())+decoMin+Math.random()*decoVar}
  function updateDeco(now){if(bgDecos.length>=MAX_DECOS)return;if(now>=decoTimer){const t=pickDeco();const s=0.85+Math.random()*0.4;bgDecos.push({x:W+40,y:randY(),w:Math.round(t.w*s),h:Math.round(t.h*s),img:t.img});scheduleDeco()}}
  function drawDecos(){const v=worldSpeed*0.5;for(let i=bgDecos.length-1;i>=0;i--){const d=bgDecos[i];d.x-=v;if(d.img.complete)ctx.drawImage(d.img,d.x,d.y,d.w,d.h);if(d.x<-d.w-20)bgDecos.splice(i,1)}}

  const playerSprites={run:[Object.assign(new Image(),{src:"assets/player_run1.png"}),Object.assign(new Image(),{src:"assets/player_run2.png"})],jump:Object.assign(new Image(),{src:"assets/player_jump.png"})}
  let RUN_FRAME_MS=140,playerAnimTimerMs=0,playerAnimFrame=0,lastFrameTs=(performance.now?performance.now():Date.now())
  function drawPlayer(){const inAir=!player.onGround;if(inAir){const j=playerSprites.jump;if(j.complete)ctx.drawImage(j,player.x,player.y,player.w,player.h)}else{const now=(performance.now?performance.now():Date.now());const dt=Math.min(100,now-lastFrameTs);lastFrameTs=now;playerAnimTimerMs+=dt;if(playerAnimTimerMs>=RUN_FRAME_MS){playerAnimTimerMs-=RUN_FRAME_MS;playerAnimFrame=(playerAnimFrame+1)%2}const r=playerSprites.run[playerAnimFrame];if(r.complete)ctx.drawImage(r,player.x,player.y,player.w,player.h)}}

  let GRAVITY=0.85,JUMP_VEL1=-12.2,JUMP_VEL2=-9.5,JUMP2_WINDOW_MS=400,JUMP2_MIN_UP_VY=1
  const TARGET_END_SPEED=11.8,SESSION_LEN_S=120,SPEED_START=5.76,SPEED_ACCEL=(TARGET_END_SPEED-SPEED_START)/SESSION_LEN_S
  let SPAWN_MIN=340,SPAWN_VAR=300
  let worldSpeed=SPEED_START,score=0,best=0,gameOver=false,ready=false,runStart=Date.now();let rafId=null
  const player={x:50,y:GROUND_Y-56,w:56,h:56,vy:0,onGround:true,jumpCount:0,maxJumps:2,firstJumpAt:0}

  const SPRITES={HIGH:loadImg("assets/obstacle_high.png"),WIDE:loadImg("assets/obstacle_wide.png"),MEDIUM:loadImg("assets/obstacle_medium.png"),FLY:loadImg("assets/obstacle_fly.png")}
  const obstacles=[];let spawnTimer=0,lastType=-1
  function typeNoRepeat(){let pool=[0,1,2,3];if(lastType!==-1)pool=pool.filter(t=>t!==lastType);const t=pool[Math.floor(Math.random()*pool.length)];lastType=t;return t}
  function spawnObstacle(){const type=typeNoRepeat();let w,h,y,sprite;if(type===0){w=56;h=56;sprite=SPRITES.MEDIUM;y=GROUND_Y-h}else if(type===1){w=96;h=56;sprite=SPRITES.WIDE;y=GROUND_Y-h}else if(type===2){w=52;h=104;sprite=SPRITES.HIGH;y=GROUND_Y-h}else{w=64;h=40;sprite=SPRITES.FLY;y=GROUND_Y-90-h;if(y<16)y=16}obstacles.push({x:W+10,y,w,h,sprite,passed:false,type})}
  const OB_HIT_W=0.85,OB_HIT_H=0.80,PL_HIT_W=0.80,PL_HIT_H=0.90,OB_HIGH_HIT_W=0.78,OB_HIGH_HIT_H=0.70
  function playerHB(p){const w=p.w*PL_HIT_W,h=p.h*PL_HIT_H;const x=p.x+(p.w-w)/2;const y=p.y+(p.h-h);return{x,y,w,h}}
  function obstacleHB(o){let w,h;if(o.type===2){w=o.w*OB_HIGH_HIT_W;h=o.h*OB_HIGH_HIT_H}else{w=o.w*OB_HIT_W;h=o.h*OB_HIT_H}const x=o.x+(o.w-w)/2;const air=o.y<(GROUND_Y-o.h);const y=air?(o.y+(o.h-h)/2):(o.y+(o.h-h));return{x,y,w,h}}
  function overlap(a,b){return a.x<b.x+b.w&&a.x+a.w>b.x&&a.y<b.y+b.h&&a.y+a.h>b.y}

  function jump(){if(gameOver||!sessionActive()||!ready)return;if(player.onGround){player.vy=JUMP_VEL1;player.onGround=false;player.jumpCount=1;player.firstJumpAt=Date.now();return}const since=Date.now()-player.firstJumpAt;if(player.jumpCount===1&&since<=JUMP2_WINDOW_MS&&player.vy<JUMP2_MIN_UP_VY){player.vy=JUMP_VEL2;player.jumpCount=2}}
  window.addEventListener('keydown',e=>{if(e.code==='Space'||e.code==='ArrowUp'){e.preventDefault();jump()}if(e.code==='Enter'&&(gameOver||!sessionActive()))startCountdown(()=>resetRun())})
  canvas.addEventListener('pointerdown',jump)

  function loop(){if(rafId)cancelAnimationFrame(rafId);rafId=requestAnimationFrame(update)}
  function update(){
    drawBackground();updateDeco((performance.now?performance.now():Date.now()));drawDecos()
    const g=ctx.createLinearGradient(0,GROUND_Y,W,GROUND_Y);g.addColorStop(0,"#53B5AF");g.addColorStop(1,"#53B5AF");ctx.fillStyle=g;ctx.fillRect(0,GROUND_Y,W,2)
    if(!sessionActive()){dimOverlay('–°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');return}
    const elapsed=(Date.now()-runStart)/1000;worldSpeed=SPEED_START+SPEED_ACCEL*elapsed
    spawnTimer-=worldSpeed;if(spawnTimer<=0){spawnObstacle();const bonus=(Math.random()<0.18)?160:0;spawnTimer=SPAWN_MIN+Math.random()*SPAWN_VAR+bonus}
    player.vy+=GRAVITY;player.y+=player.vy;if(player.y>=GROUND_Y-player.h){player.y=GROUND_Y-player.h;player.vy=0;if(!player.onGround){player.onGround=true;player.jumpCount=0}}else{player.onGround=false}
    for(let i=obstacles.length-1;i>=0;i--){const o=obstacles[i];o.x-=worldSpeed;if(o.sprite&&o.sprite.complete)ctx.drawImage(o.sprite,o.x,o.y,o.w,o.h);else{ctx.fillStyle='#53B5AF';ctx.fillRect(o.x,o.y,o.w,o.h)}if(o.x+o.w<0)obstacles.splice(i,1);if(!o.passed&&o.x+o.w<player.x){o.passed=true;score++;updateHud()}if(!gameOver&&overlap(playerHB(player),obstacleHB(o))){gameOver=true;if(score>best){best=score;updateHud()}}}
    drawPlayer()
    if(!ready){drawCountdown();return}
    if(gameOver)return
    loop()
  }

  const scoreEl=document.getElementById('score');const bestEl=document.getElementById('best');const timeEl=document.getElementById('timeLeft')
  document.getElementById('restart').onclick=()=>{if(!sessionActive())return;startCountdown(()=>resetRun())}
  document.getElementById('newSession').onclick=openReg
  function updateHud(){scoreEl.textContent=String(score);bestEl.textContent=String(best)}

  const regOverlay=document.getElementById('regOverlay');const resultOverlay=document.getElementById('resultOverlay');const startBtn=document.getElementById('startBtn');const resultOk=document.getElementById('resultOk');const resultReg=document.getElementById('resultReg');const regErr=document.getElementById('regErr');const lastNameIn=document.getElementById('lastName');const firstNameIn=document.getElementById('firstName');const middleNameIn=document.getElementById('middleName');const phoneIn=document.getElementById('phone');const emailIn=document.getElementById('email');const consentIn=document.getElementById('consent');const finalBest=document.getElementById('finalBest');const prizeText=document.getElementById('prizeText')

  let profile=null,sessionEndAt=null,timerId=null
  function openReg(){regErr.textContent='';regOverlay.style.display='flex'}
  function closeReg(){regOverlay.style.display='none'}
  function normalizePhone(raw){if(!raw)return"";let d=raw.replace(/[^\d]/g,'');if(d.length===11&&d[0]==='8')d='7'+d.slice(1);if(d.length===10)d='7'+d;if(d.length===11&&d[0]==='7')return'+7'+d.slice(1);return""}
  function isEmailValid(v){if(!v)return true;return/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(v.trim())}

  startBtn.onclick=function(){
    const lastName=lastNameIn.value.trim();const firstName=firstNameIn.value.trim();const middleName=middleNameIn.value.trim();const phoneRaw=phoneIn.value.trim();const email=emailIn.value.trim()
    if(!lastName){regErr.textContent='–£–∫–∞–∂–∏—Ç–µ —Ñ–∞–º–∏–ª–∏—é';return}
    if(!firstName){regErr.textContent='–£–∫–∞–∂–∏—Ç–µ –∏–º—è';return}
    const phone=normalizePhone(phoneRaw);if(!phone){regErr.textContent='–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω. –ü—Ä–∏–º–µ—Ä: +7 900 000-00-00';return}
    if(!consentIn.checked){regErr.textContent='–ù—É–∂–Ω–æ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö';return}
    if(!isEmailValid(email)){regErr.textContent='–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π e-mail';return}
    profile={lastName,firstName,middleName,phone,email}
    best=0;score=0;updateHud()
    sessionEndAt=Date.now()+2*60*1000
    closeReg()
    startCountdown(()=>{resetRun();tickTimer()})
  }

  resultOk.onclick=function(){resultOverlay.style.display='none'}
  resultReg.onclick=function(){resultOverlay.style.display='none';openReg()}

  function tickTimer(){clearInterval(timerId);timerId=setInterval(function(){const left=Math.max(0,(sessionEndAt||0)-Date.now());timeEl.textContent=fmt(left);if(left<=0){clearInterval(timerId);showResults()}},200)}
  function fmt(ms){const s=Math.ceil(ms/1000),m=Math.floor(s/60),ss=('0'+(s%60)).slice(-2);return('0'+m).slice(-2)+':'+ss}
  function sessionActive(){return sessionEndAt&&Date.now()<sessionEndAt}

  function showResults(){
    finalBest.textContent=String(best);prizeText.textContent=getPrize(best)
    try{if(window.Telegram&&window.Telegram.WebApp){const payload={type:'lead',profile,best,ts:Date.now()};Telegram.WebApp.sendData(JSON.stringify(payload))}}catch(e){}
    resultOverlay.style.display='flex'
  }
  function getPrize(p){if(p>=70)return'–¢–µ—Ä–º–æ—Å';if(p>=50)return'–®–æ–ø–ø–µ—Ä';if(p>=30)return'–ë–ª–æ–∫–Ω–æ—Ç –∏ —Ä—É—á–∫–∞';if(p>=20)return'–ë—Ä–µ–ª–æ–∫';return'‚Äî'}

  function startCountdown(cb){ready=false;let t=3;function step(){drawCountdown(t);if(t===0){ready=true;cb&&cb();return}setTimeout(function(){t--;step()},500)}step()}
  function drawCountdown(n){drawBackground();updateDeco((performance.now?performance.now():Date.now()));drawDecos();const g=ctx.createLinearGradient(0,GROUND_Y,W,GROUND_Y);g.addColorStop(0,'#53B5AF');g.addColorStop(1,'#53B5AF');ctx.fillStyle=g;ctx.fillRect(0,GROUND_Y,W,2);ctx.fillStyle='rgba(0,0,0,.35)';ctx.fillRect(0,0,W,H);ctx.font='bold 56px monospace';ctx.textAlign='center';ctx.fillStyle='#53B5AF';ctx.fillText((typeof n==='number')?n:' ',W/2,H/2)}
  function dimOverlay(msg){ctx.fillStyle='rgba(0,0,0,.6)';ctx.fillRect(0,0,W,H);ctx.font='16px monospace';ctx.textAlign='center';ctx.fillStyle='#ffffff';ctx.fillText(msg,W/2,H/2)}
  function resetRun(){runStart=Date.now();worldSpeed=SPEED_START;score=0;gameOver=false;player.y=GROUND_Y-player.h;player.vy=0;player.onGround=true;player.jumpCount=0;playerAnimTimerMs=0;playerAnimFrame=0;lastFrameTs=(performance.now?performance.now():Date.now());obstacles.length=0;spawnTimer=0;bgDecos.length=0;bgOffset=0;scheduleDeco();if(rafId)cancelAnimationFrame(rafId);rafId=null;loop()}

  document.getElementById('regOverlay').style.display='flex'
  ;(function(){ctx.fillStyle='#000000';ctx.fillRect(0,0,W,H);const g=ctx.createLinearGradient(0,GROUND_Y,W,GROUND_Y);g.addColorStop(0,'#53B5AF');g.addColorStop(1,'#53B5AF');ctx.fillStyle=g;ctx.fillRect(0,GROUND_Y,W,2)})()
})();
</script>
</body>
</html>
