<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>–ü—Ä–æ—Ñ–¢—Ä–µ–π–¥–õ–∞–± ‚Äî 8‚Äëbit Runner</title>
  <!-- –ë—Ä–µ–Ω–¥–æ–≤—ã–π favicon (–∞–∫–≤–∞-—Ü–∏–∞–Ω) -->
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="46" fill="%2317F1E9"/><text x="50" y="70" text-anchor="middle" font-size="70" fill="black">üß™</text></svg>'>
  <style>
    :root{
      /* –ë—Ä–µ–Ω–¥-–ø–∞–ª–∏—Ç—Ä–∞ ProfTradeLab */
      --brand: #17F1E9;        /* –æ—Å–Ω–æ–≤–Ω–æ–π –∞–∫—Ü–µ–Ω—Ç */
      --brand-2: #00C1C4;      /* —Ö–æ–≤–µ—Ä/–≤—Ç–æ—Ä–∏—á–Ω—ã–π */
      --brand-glow: 0 0 18px rgba(72,207,175,.55);
      /* –ò–≥—Ä–æ–≤–∞—è —Ç–µ–º–∞ 8-bit */
      --bg:#000; --card:#0b0b0b; --ok:#0f0; --bad:#f33; --accent:#17F1E9; --accent2:#00C1C4;
    }
    *{ box-sizing: border-box; }
    html, body { height: 100%; margin: 0; font-family: monospace; background: var(--bg); color: #d9fff9; }
    body { display: grid; place-items: center; }
    .wrap { width: 100%; max-width: 740px; padding: 12px; }
    .card {
      background: var(--card);
      border:3px solid var(--brand);
      image-rendering: pixelated;
      box-shadow: var(--brand-glow);
      border-radius: 8px;
    }
    h1 { font-size: 20px; margin: 0; padding: 10px 12px; color:#d9fff9; display:flex; align-items:center; gap:10px;
      background: linear-gradient(45deg, rgba(23,241,233,.08), rgba(0,193,196,.08)); border-bottom:1px solid rgba(23,241,233,.35);
    }
    .pill { font-size:12px; border:2px solid var(--brand); padding:2px 6px; border-radius:6px; }
    #game { width: 100%; height: auto; background: #111; display: block; image-rendering: pixelated; }
    .bar { font-size:14px; margin:8px 0; padding:8px 12px; display:flex; justify-content:space-between; align-items:center; gap:8px; color:#bffff6; }
    .btn {
      background:#101010; color:#d9fff9; border:2px solid var(--brand); font-family:monospace; padding:8px 12px; cursor:pointer; border-radius:8px;
      box-shadow: var(--brand-glow);
    }
    .btn:active { background:var(--brand); color:#001314; }
    .btn.brand { background: linear-gradient(0.125turn, var(--brand) 0%, var(--brand-2) 100%); color:#001314; border-color:transparent; }
    .muted { color:#9beee7; opacity:.9 }
    .overlay{ position:fixed; inset:0; background:rgba(0,0,0,.9); display:none; align-items:center; justify-content:center; color:#d9fff9; }
    .panel{ background:#0e0e0e; border:3px solid var(--brand); padding:14px; width:90%; max-width:520px; border-radius:8px; box-shadow: var(--brand-glow); }
    input[type="text"], input[type="email"], input[type="tel"]{
      width:100%; background:#000; border:2px solid var(--brand); color:#cffff8; padding:8px; margin:6px 0; border-radius:6px;
    }
    .checkbox{ display:flex; gap:8px; align-items:flex-start; font-size:12px; color:#bffff6; }
    .hint { font-size:12px; color:#9beee7; }
    .countdown { position:absolute; left:50%; top:45%; transform:translate(-50%,-50%); font-size:56px; color:var(--brand); text-shadow:0 0 16px rgba(23,241,233,.7); }
    @media (max-width: 560px){
      .bar { flex-direction: column; align-items:flex-start; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>üß™ –ü—Ä–æ—Ñ–¢—Ä–µ–π–¥–õ–∞–± 8‚Äëbit Runner <span class="pill">beta</span></h1>
      <canvas id="game" width="720" height="240"></canvas>
      <div class="bar">
        <div class="muted">
          –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: Space / ‚¨ÜÔ∏é / –¢–∞–ø &nbsp;|&nbsp;
          –û—á–∫–∏: <span id="score">0</span> ¬∑ –†–µ–∫–æ—Ä–¥: <span id="best">0</span> ¬∑ –û—Å—Ç–∞–ª–æ—Å—å: <span id="timeLeft">02:00</span>
          <div class="hint">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –Ω–∞–∂–∏–º–∞–π—Ç–µ –∑–∞—Ä–∞–Ω–µ–µ ‚Äî –ø—Ä—ã–∂–æ–∫ ¬´–¥–ª–∏–Ω–Ω–µ–µ¬ª, —É–¥–∞—Ä—å—Ç–µ—Å—å ‚Äî –∂–º–∏—Ç–µ ¬´–ó–∞–Ω–æ–≤–æ¬ª.</div>
        </div>
        <div style="display:flex; gap:8px; flex-wrap:wrap">
          <button id="restart" class="btn">–ó–∞–Ω–æ–≤–æ</button>
          <button id="newSession" class="btn brand">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        </div>
      </div>
    </div>
  </div>

  <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
  <div id="regOverlay" class="overlay" style="display:flex">
    <div class="panel">
      <h2 style="margin:4px 0 10px">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
      <input id="fio" type="text" placeholder="–§–ò–û">
      <input id="phone" type="tel" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
      <input id="email" type="email" placeholder="Email">
      <label class="checkbox"><input id="consent" type="checkbox"> –°–æ–≥–ª–∞—Å–µ–Ω –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</label>
      <div class="hint">–î–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤—ã–¥–∞—á–∏ –ø—Ä–∏–∑–∞ –∏ —Å–≤—è–∑–∏ —Å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è–º–∏.</div>
      <div style="margin-top:12px; text-align:right;">
        <button id="startBtn" class="btn brand">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
      </div>
      <div id="regErr" style="color:#ff8a8a; margin-top:6px;"></div>
    </div>
  </div>

  <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
  <div id="resultOverlay" class="overlay">
    <div class="panel">
      <h2 style="margin:4px 0 10px">–°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞</h2>
      <p>–í–∞—à –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <b id="finalBest">0</b></p>
      <p>–í–∞—à –ø—Ä–∏–∑: <b id="prizeText">‚Äî</b></p>
      <div style="margin-top:12px;text-align:right;">
        <button id="resultOk" class="btn brand">–ù–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
      </div>
    </div>
  </div>

<script>
(function(){
  // === –ò–ì–†–û–í–ê–Ø –õ–û–ì–ò–ö–ê (—Å–º—è–≥—á—ë–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å) ===
  const canvas=document.getElementById("game"),ctx=canvas.getContext("2d");
  const W=canvas.width,H=canvas.height,GROUND_Y=H-32,GRAVITY=0.65,     // —á—É—Ç—å –º—è–≥—á–µ –ø–∞–¥–µ–Ω–∏–µ
        JUMP_VELOCITY=-12.2,                                          // –ø—Ä—ã–∂–æ–∫ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–µ–µ
        SPEED_START=5,                                                 // –±—ã–ª–æ 6
        SPEED_INC=0.00035;                                             // –±—ã–ª–æ 0.0009 (–∑–∞–º–µ—Ç–Ω–æ –º—è–≥—á–µ)

  let worldSpeed=SPEED_START,score=0,best=0,gameOver=false, ready=false;
  const player={x:50,y:GROUND_Y-20,w:20,h:20,vy:0,onGround:true};
  const obstacles=[]; let spawnTimer=0;                                // —Ä–µ—Å–ø —Ä–µ–∂–µ:
  const SPAWN_MIN=160, SPAWN_VAR=160;                                  // —Ä–∞–Ω—å—à–µ ~100‚Äì120

  function resetRun(){worldSpeed=SPEED_START;score=0;gameOver=false;player.y=GROUND_Y-player.h;player.vy=0;player.onGround=true;obstacles.length=0;spawnTimer=0;loop();}

  function spawnObstacle(){
    const s=10+Math.floor(Math.random()*20);
    obstacles.push({x:W+10,y:GROUND_Y-s,w:s,h:s,passed:false});
  }

  function jump(){ if(gameOver || !sessionActive() || !ready) return; if(player.onGround){ player.vy=JUMP_VELOCITY; player.onGround=false; } }
  window.addEventListener("keydown",e=>{ if(e.code==="Space"||e.code==="ArrowUp"){e.preventDefault();jump();} if(e.code==="Enter"&&(gameOver||!sessionActive())) resetRun();});
  canvas.addEventListener("pointerdown",jump);

  let rafId=null; function loop(){ cancelAnimationFrame(rafId); rafId=requestAnimationFrame(update); }

  function update(){
    ctx.fillStyle="#000"; ctx.fillRect(0,0,W,H);
    // –∑–µ–º–ª—è —Å –±—Ä–µ–Ω–¥–æ–≤–æ–π –ª–∏–Ω–∏–µ–π
    const grd=ctx.createLinearGradient(0,GROUND_Y,W,GROUND_Y);
    grd.addColorStop(0,"#17F1E9"); grd.addColorStop(1,"#00C1C4");
    ctx.fillStyle=grd; ctx.fillRect(0,GROUND_Y,W,2);

    if(!sessionActive()){ dimOverlay("–°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞"); return; }

    spawnTimer -= worldSpeed;
    if (spawnTimer <= 0) { spawnObstacle(); spawnTimer = SPAWN_MIN + Math.random()*SPAWN_VAR; }

    // –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
    player.vy += GRAVITY; player.y += player.vy;
    if (player.y >= GROUND_Y - player.h) { player.y = GROUND_Y - player.h; player.vy = 0; player.onGround = true; }

    // –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è + ¬´–ø—Ä–æ—â–µ–Ω–∏–µ¬ª —Ö–∏—Ç–±–æ–∫—Å–∞ (—Å–Ω–∏–∂–∞–µ–º –Ω–∞ 2px)
    ctx.fillStyle="#17F1E9";
    for (let i=obstacles.length-1;i>=0;i--){
      const o=obstacles[i]; o.x -= worldSpeed;
      ctx.fillRect(o.x,o.y,o.w,o.h);
      if (o.x + o.w < 0) obstacles.splice(i,1);
      if (!o.passed && o.x + o.w < player.x) { o.passed=true; score++; updateHud(); }
      if (!gameOver && collideForgiven(player,o,2)) { gameOver=true; if(score>best){best=score; updateHud();} }
    }

    // –∏–≥—Ä–æ–∫
    ctx.fillStyle = gameOver ? "#f33" : "#0f0";
    ctx.fillRect(player.x,player.y,player.w,player.h);

    // –æ–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á—ë—Ç –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º –ø–æ–ø—ã—Ç–∫–∏
    if (!ready) { drawCountdown(); return; }

    if (gameOver) return;
    worldSpeed += SPEED_INC;
    loop();
  }

  function collideForgiven(a,b,forgive){
    // AABB —Å ¬´–ø—Ä–æ—â–µ–Ω–∏–µ–º¬ª: —á—É—Ç—å —É–º–µ–Ω—å—à–∞–µ–º –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ
    const bx=b.x+forgive, by=b.y+forgive, bw=b.w-2*forgive, bh=b.h-2*forgive;
    return a.x < bx + bw && a.x + a.w > bx && a.y < by + bh && a.y + a.h > by;
  }

  // HUD/–∫–Ω–æ–ø–∫–∏
  const scoreEl=document.getElementById("score"),bestEl=document.getElementById("best"),timeEl=document.getElementById("timeLeft");
  document.getElementById("restart").onclick=()=>{ if(sessionActive()){ ready=false; startCountdown(()=>{ resetRun(); }); } };
  document.getElementById("newSession").onclick=openReg;
  function updateHud(){ scoreEl.textContent=score; bestEl.textContent=best; }

  // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ —Å–µ—Å—Å–∏—è (—Ç–µ–ø–µ—Ä—å 2 –º–∏–Ω—É—Ç—ã)
  const regOverlay=document.getElementById("regOverlay"),resultOverlay=document.getElementById("resultOverlay");
  const startBtn=document.getElementById("startBtn"),resultOk=document.getElementById("resultOk"),regErr=document.getElementById("regErr");
  const fioIn=document.getElementById("fio"),phoneIn=document.getElementById("phone"),emailIn=document.getElementById("email"),consentIn=document.getElementById("consent");
  const finalBest=document.getElementById("finalBest"),prizeText=document.getElementById("prizeText");
  let profile=null,sessionEndAt=null;

  function openReg(){ regErr.textContent=""; regOverlay.style.display="flex"; }
  function closeReg(){ regOverlay.style.display="none"; }

  startBtn.onclick=()=>{
    const fio=fioIn.value.trim(), phone=phoneIn.value.trim(), email=emailIn.value.trim();
    if(!fio) { regErr.textContent="–£–∫–∞–∂–∏—Ç–µ –§–ò–û"; return; }
    if(!consentIn.checked){ regErr.textContent="–ù—É–∂–Ω–æ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"; return; }
    profile={fio, phone, email};
    best=0; score=0; updateHud();
    sessionEndAt = Date.now() + 2*60*1000;  // ‚Üê 2 –º–∏–Ω—É—Ç—ã
    closeReg();
    // –∫–æ—Ä–æ—Ç–∫–∏–π –æ—Ç—Å—á—ë—Ç –∏ —Å—Ç–∞—Ä—Ç
    ready=false; startCountdown(()=>{ resetRun(); });
    tickTimer();
  };

  resultOk.onclick=()=>{ resultOverlay.style.display="none"; openReg(); };

  let timerId=null;
  function tickTimer(){
    clearInterval(timerId);
    timerId=setInterval(()=>{
      const left=Math.max(0,(sessionEndAt||0)-Date.now());
      timeEl.textContent = fmt(left);
      if(left<=0){ clearInterval(timerId); showResults(); }
    },200);
  }
  function fmt(ms){ const s=Math.ceil(ms/1000), m=Math.floor(s/60), ss=String(s%60).padStart(2,"0"); return `${String(m).padStart(2,"0")}:${ss}`; }
  function sessionActive(){ return sessionEndAt && Date.now()<sessionEndAt; }

  function showResults(){
    finalBest.textContent = String(best);
    prizeText.textContent = getPrize(best);
    resultOverlay.style.display="flex";
  }

  function getPrize(p){
    if (p>=3000) return "–¢–µ—Ä–º–æ—Å";
    if (p>=2000) return "–®–æ–ø–ø–µ—Ä";
    if (p>=1000) return "–ë–ª–æ–∫–Ω–æ—Ç –∏ —Ä—É—á–∫–∞";
    if (p>=500)  return "–ë—Ä–µ–ª–æ–∫";
    return "‚Äî";
  }

  // 3‚Äë2‚Äë1 –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º/—Ä–µ—Å—Ç–∞—Ä—Ç–æ–º
  function startCountdown(cb){
    let t=3;
    const tick=()=>{
      drawCountdown(t);
      if(t===0){ ready=true; cb&&cb(); }
      else setTimeout(()=>{ t--; tick(); }, 500); // –±—ã—Å—Ç—Ä—ã–π 0.5—Å —à–∞–≥, —á—Ç–æ–±—ã –Ω–µ —Ç–æ—Ä–º–æ–∑–∏—Ç—å –∏–≥—Ä–æ–∫–∞
    };
    tick();
  }
  function drawCountdown(n){
    ctx.fillStyle="rgba(0,0,0,.35)"; ctx.fillRect(0,0,W,H);
    ctx.font="bold 56px monospace"; ctx.textAlign="center"; ctx.fillStyle="#17F1E9";
    ctx.fillText(n??" ", W/2, H/2);
  }

  function dimOverlay(msg){
    ctx.fillStyle="rgba(0,0,0,.6)"; ctx.fillRect(0,0,W,H);
    ctx.font="16px monospace"; ctx.textAlign="center"; ctx.fillStyle="#d9fff9";
    ctx.fillText(msg, W/2, H/2);
  }

  // –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
  openReg(); updateHud();
  // —Å—Ç–∞—Ç–∏—á–Ω–∞—è –ø–æ–¥–ª–æ–∂–∫–∞ –¥–æ —Å—Ç–∞—Ä—Ç–∞
  (function first(){ ctx.fillStyle="#000"; ctx.fillRect(0,0,W,H); const g=ctx.createLinearGradient(0,GROUND_Y,W,GROUND_Y); g.addColorStop(0,"#17F1E9"); g.addColorStop(1,"#00C1C4"); ctx.fillStyle=g; ctx.fillRect(0,GROUND_Y,W,2); })();
})();
</script>
</body>
</html>
